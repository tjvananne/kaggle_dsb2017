

# PHASE 2: process and segment dicom files

Phase 1 was training an algorithm to identify nodules using the LUNA 16 dataset. The original authors of this project give the reader three different choices for how they'd like to implement this same functionality:

1) simply copy the pre-trained model weights provided in their repository (stored in a .h5 file) 
	- **this is the option I'm choosing** - it is the simplest and I don't think I could train the algorithm better than these people did
2) retrain the nodule identifier model from the pieces they provide
3) build the model architecture, preprocessing techniques, and model parameters from scratch using only the LUNA data


Because I chose the first option above, I can safely assume that my starting point in this project will be from the dicom files onward.


This sub directory shows the process of taking in the dicom files (Kaggle, in this instance), normalizing and preprocessing the images, and segmenting/isolating the lungs. This data is then stored for each patient in various versions of .npz files. 

Dicom files are read in from the `<PROJECT ROOT>/input/stage1/<patient id dir>/< ~200 image id>.dcm` location. One they are processed as numpy ndarrays, they are written out to disk in these directories:


* `<PROJECT ROOT>/input/stage1_2x2x2/<patient id>.npz`
* `<PROJECT ROOT>/input/stage1_segmented_2x2x2/<patient_id>.npz`
* `<PROJECT ROOT>/input/stage1_segmented_2x2x2_crop/<patient id>.npz`


I haven't really explored the differences between these three types of .npz outputs listed in different directories above, but I think that will become much more clear once I look at the next stage of the project as a whole. 


<PROJECT ROOT>
|
|__py_script (name this whatever)
|   |
|   |__<THIS FILE YOU'RE READING.py>
|
|__input
    |
    |__stage1
    |   |
    |   |__<patient one dir name>
    |   |   |
    |   |   |__<image id>.dcm (~200 of these per patient)
    |   |   |__<image id>.dcm
    |   |  
    |   |
    |   |__<patient two dir name>
    |   |   |   
    |   |   |__<image id>.dcm (~200 of these per patient)
    |   |   |__<image id>.dcm
    |   |
    |   |
    |   |__<patient 'n' dir name>
    |   |   |   
    |   |   |__<image id>.dcm (~200 of these per patient)
    |   |   |__<image id>.dcm
    |   |  
    |   |
    |__stage1_2x2x2 (create this, leave it empty)
    |   |
    |   |
    |   |   (these files generated by this script, one .npz per patient)
    |   |__<patient one id>.npz 
    |   |__<patient two id>.npz
    |   |__<patient n id>.npz
    |
    |
    |__stage1_segmented_2x2x2 (create this, leave it empty) 
    |   |
    |   |__<patient one id>.npz (this script generates these)
    |   |__<patient two id>.npz
    |   |__<patient n id>.npz 
    |
    |
    |__stage1_segmented_2x2x2_crop (create this, leave empty)
        |
        |__<patient one id>.npz (this script generates these)
        |__<patient two id>.npz
        |__<patient n id>.npz 



Based on the above info:
Path to dicom files is:
"../input/stage1/<patient id dir name>/<image id>.dcm"
